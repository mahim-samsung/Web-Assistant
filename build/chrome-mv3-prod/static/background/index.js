!function(e){var t;"function"==typeof e&&(t=e,e=null),function(t,r,a,s,n){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o="function"==typeof i[s]&&i[s],l=o.cache||{},c="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function p(e,r){if(!l[e]){if(!t[e]){var a="function"==typeof i[s]&&i[s];if(!r&&a)return a(e,!0);if(o)return o(e,!0);if(c&&"string"==typeof e)return c(e);var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}d.resolve=function(r){var a=t[e][1][r];return null!=a?a:r},d.cache={};var h=l[e]=new p.Module(e);t[e][0].call(h.exports,d,h,h.exports,this)}return l[e].exports;function d(e){var t=d.resolve(e);return!1===t?{}:p(t)}}p.isParcelRequire=!0,p.Module=function(e){this.id=e,this.bundle=p,this.exports={}},p.modules=t,p.cache=l,p.parent=o,p.register=function(e,r){t[e]=[function(e,t){t.exports=r},{}]},Object.defineProperty(p,"root",{get:function(){return i[s]}}),i[s]=p;for(var h=0;h<r.length;h++)p(r[h]);if(a){var d=p(a);"object"==typeof exports&&"undefined"!=typeof module?module.exports=d:"function"==typeof e&&e.amd?e(function(){return d}):n&&(this[n]=d)}}({kgW6q:[function(e,t,r){e("./messaging"),e("../../../src/background/index")},{"./messaging":"iG3ww","../../../src/background/index":"knbGc"}],iG3ww:[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js"),s=e("~background/messages/openSetting"),n=a.interopDefault(s),i=e("~background/messages/popupCheck"),o=a.interopDefault(i),l=e("~background/messages/signInSuccess"),c=a.interopDefault(l);globalThis.__plasmoInternalPortMap=new Map,chrome.runtime.onMessage.addListener((e,t,r)=>{switch(e.name){case"openSetting":(0,n.default)({sender:t,...e},{send:e=>r(e)});break;case"popupCheck":(0,o.default)({sender:t,...e},{send:e=>r(e)});break;case"signInSuccess":(0,c.default)({sender:t,...e},{send:e=>r(e)})}return!0}),chrome.runtime.onConnect.addListener(function(e){globalThis.__plasmoInternalPortMap.set(e.name,e),e.onMessage.addListener(function(t){e.name})})},{"~background/messages/openSetting":"iKA45","~background/messages/popupCheck":"9V9Hh","~background/messages/signInSuccess":"6MjRo","@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],iKA45:[function(e,t,r){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r);let a=async()=>{chrome.runtime.openOptionsPage()};r.default=a},{"@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],f6DG4:[function(e,t,r){r.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},r.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.exportAll=function(e,t){return Object.keys(e).forEach(function(r){"default"===r||"__esModule"===r||t.hasOwnProperty(r)||Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[r]}})}),t},r.export=function(e,t,r){Object.defineProperty(e,t,{enumerable:!0,get:r})}},{}],"9V9Hh":[function(e,t,r){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r);var a=e("@plasmohq/messaging"),s=e("@/config");let n=async(e,t)=>{let[r]=await chrome.tabs.query({active:!0,currentWindow:!0}),n=r?.url,i=!0;n&&(i=n.startsWith("chrome:")||n.startsWith("chrome-extension:")),t.send(i),i||(0,a.sendToContentScript)({name:s.MESSAGING_EVENT.SHOW_POPUP})};r.default=n},{"@plasmohq/messaging":"e7sqG","@/config":"jKBVv","@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],e7sqG:[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"relay",()=>f),a.export(r,"relayMessage",()=>g),a.export(r,"sendToActiveContentScript",()=>m),a.export(r,"sendToBackground",()=>d),a.export(r,"sendToBackgroundViaRelay",()=>y),a.export(r,"sendToContentScript",()=>u),a.export(r,"sendViaRelay",()=>w);var s=e("nanoid"),n=globalThis.browser?.runtime||globalThis.chrome?.runtime,i=globalThis.browser?.tabs||globalThis.chrome?.tabs,o=()=>{if(!n)throw Error("Extension runtime is not available");return n},l=()=>{if(!i)throw Error("Extension tabs API is not available");return i},c=async()=>{let e=l(),[t]=await e.query({active:!0,currentWindow:!0});return t},p=(e,t)=>!t.__internal&&e.source===globalThis.window&&e.data.name===t.name&&(void 0===t.relayId||e.data.relayId===t.relayId),h=(e,t,r=globalThis.window)=>{let a=async a=>{if(p(a,e)&&!a.data.relayed){let s={name:e.name,relayId:e.relayId,body:a.data.body},n=await t?.(s);r.postMessage({name:e.name,relayId:e.relayId,instanceId:a.data.instanceId,body:n,relayed:!0},{targetOrigin:e.targetOrigin||"/"})}};return r.addEventListener("message",a),()=>r.removeEventListener("message",a)},d=async e=>o().sendMessage(e),u=async e=>{let t="number"==typeof e.tabId?e.tabId:(await c()).id;return l().sendMessage(t,e)},m=u,g=e=>h(e,d),f=g,y=(e,t=globalThis.window)=>new Promise((r,a)=>{let n=(0,s.nanoid)(),i=new AbortController;t.addEventListener("message",t=>{p(t,e)&&t.data.relayed&&t.data.instanceId===n&&(r(t.data.body),i.abort())},{signal:i.signal}),t.postMessage({...e,instanceId:n},{targetOrigin:e.targetOrigin||"/"})}),w=y},{nanoid:"9D4Je","@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],"9D4Je":[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"urlAlphabet",()=>s.urlAlphabet),a.export(r,"random",()=>n),a.export(r,"customRandom",()=>i),a.export(r,"customAlphabet",()=>o),a.export(r,"nanoid",()=>l);var s=e("./url-alphabet/index.js");let n=e=>crypto.getRandomValues(new Uint8Array(e)),i=(e,t,r)=>{let a=(2<<Math.log(e.length-1)/Math.LN2)-1,s=-~(1.6*a*t/e.length);return (n=t)=>{let i="";for(;;){let t=r(s),o=s;for(;o--;)if((i+=e[t[o]&a]||"").length===n)return i}}},o=(e,t=21)=>i(e,t,n),l=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>((t&=63)<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"")},{"./url-alphabet/index.js":!1,"@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],jKBVv:[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"WEBPILOT_CONFIG_STORAGE_KEY",()=>n),a.export(r,"OPENAI_BASE_URL",()=>i),a.export(r,"API_PATH",()=>o),a.export(r,"defaultConfig",()=>l),a.export(r,"MESSAGING_EVENT",()=>c),a.export(r,"SUPER_BUTTON_STATUS",()=>p),a.export(r,"WEBPILOT_OPENAI",()=>h),a.export(r,"LAST_PROMPT_STORAGE_KEY",()=>d),a.export(r,"API_ORIGINS",()=>u),a.export(r,"SERVER_NAME",()=>m),a.export(r,"SERVER_TYPE",()=>g),a.export(r,"OPTIONS_PAGE_TAB_NAME",()=>f);var s=e("./utils/i18n");let n="WEBPILOT_CONFIG_STORAGE_KEY",i="https://api.openai.com",o="/v1/chat/completions",l={apiOrigin:"general",authKey:"",isAuth:!1,isFinishSetup:!1,autoPopup:!1,selfHostUrl:"",azureApiVersion:"",azureDeploymentID:"",customShortcut:["Control","`"],displayMode:"popUp",showShortcutTips:!0,latestAskedQuestionPromptIndex:0,latestTextSelectionPromptIndex:0,AskedQuestionPrompts:[{title:(0,s.$gettext)("Summarize"),command:(0,s.$gettext)("Summarize in English, concise and clear")},{title:(0,s.$gettext)("SEO"),command:(0,s.$gettext)("Generate a list of 10 long-tail keywords for SEO, related to this page")},{title:(0,s.$gettext)("Solve"),command:(0,s.$gettext)("Find the questions/todo on the page, analyze them step by step, and provide a complete solution in the end. If a specified starting point is given, use it directly without changing.")}],TextSelectionPrompts:[{title:(0,s.$gettext)("Explain"),command:(0,s.$gettext)("Explain it in English using words a middle schooler can understand")},{title:(0,s.$gettext)("Refine"),command:(0,s.$gettext)("Refine text, review and revise problems in spelling, grammar, punctuation, word usage, and sentence structure")},{title:(0,s.$gettext)("Draw"),command:(0,s.$gettext)(`Let's draw an image about this. You need to write in English without word wraps and headlines, without connection words. back to back separated with commas: [1], [2], [3], [4] {environment}, [5], [6] {style settings}
        Replace [1] with the subject "A image of ";
        Replace [2] with the sentence you mentioned;
        Replace [3] with a list of creative detailed descriptions about [element]; 
        Replace [4] with a list of detailed descriptions about the environment of the scene;
        Replace [5] with a list of detailed descriptions about the mood/feelings and atmosphere of the scene;
        Replace [6] with an appropriate director or artist. If he/she is a historical figure, include his/her country and dynasty.
        Simply write the without explanation, replace the content inside the brackets with details about the content/word inside the brackets and delete the brackets. Repeat that for every bracket in the prompt, complex prompt for an AI-based text to image program that converts a prompt about a topic into an image. The outcome depends on the prompt's coherence. The topic of the whole scene is always dependent on the subject that is replaced with [element], always start the prompt with "/imagine prompt:", don't use any line breaks, Proper grammar is unnecessary and details can be listed.
        Do not show things like "[1]""[element]" in your response.`)}],model:{model:"gpt-4o-mini",temperature:1,top_p:.9,frequency_penalty:0,presence_penalty:0,stop:"<|endoftext|>"}},c={SHOW_POPUP:"MESSAGING_EVENT"},p={pending:"pending",generating:"generating",done:"done"},h={AUTH_KEY:"KEY_PLACEHOLDER",HOST_URL:"https://api.webpilotai.com/api/webpilot",MODEL:"gpt-4o-mini"},d={COMMON:"LAST_COMMON",SELECTED:"LAST_SELECTED"},u={GENERAL:"general",OPENAI:"openAI",OPENAI_PROXY:"OpenAIProxy",AZURE:"azure"},m={OPENAI_OFFICIAL:"OPENAI_OFFICIAL",OPENAI_PROXY:"OPENAI_PROXY",AZURE_PROXY:"AZURE_PROXY"},g={[m.OPENAI_OFFICIAL]:"OpenAI Official",[m.OPENAI_PROXY]:"OpenAI Proxy",[m.AZURE_PROXY]:"Azure Proxy"},f={ACCOUNT:"ACCOUNT",EXTENSION:"EXTENSION",ABOUT:"ABOUT"}},{"./utils/i18n":"7vggY","@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],"7vggY":[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");function s(e){let t="";try{let r=e.replace(/[^A-Za-z0-9_]/g,"_");t=chrome.i18n.getMessage(r)||e}catch(r){t=e}return t}a.defineInteropFlag(r),a.export(r,"$gettext",()=>s),a.export(r,"i18nPlugin",()=>n);let n={install(e){e.config.globalProperties.$gettext=s}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],"6MjRo":[function(e,t,r){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(r);var a=e("@plasmohq/storage"),s=e("@/apiConfig");let n=chrome.runtime.getURL("./tabs/index.html"),i=async()=>{let[e]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0,url:["https://account.webpilot.ai/*","http://localhost/*"]});return e?.id},o=async e=>{let t=new a.Storage,r=await i();r&&chrome.tabs.update({url:n});let{credential:o}=e.body;t.set(s.GOOGLE_CREDENTIAL,o)};r.default=o},{"@plasmohq/storage":"3wfAg","@/apiConfig":"5FhUR","@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],"3wfAg":[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"BaseStorage",()=>o),a.export(r,"Storage",()=>l);var s=e("pify"),n=a.interopDefault(s),i=()=>{try{let e=globalThis.navigator?.userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if("Chrome"===e[1])return 100>parseInt(e[2])||globalThis.chrome.runtime?.getManifest()?.manifest_version===2}catch{}return!1},o=class{#e;#t;get primaryClient(){return this.#t}#r;get secondaryClient(){return this.#r}#a;get area(){return this.#a}get hasWebApi(){try{return"u">typeof window&&!!window.localStorage}catch(e){return console.error(e),!1}}#s=new Map;#n;get copiedKeySet(){return this.#n}isCopied=e=>this.hasWebApi&&(this.allCopied||this.copiedKeySet.has(e));#i=!1;get allCopied(){return this.#i}getExtStorageApi=()=>globalThis.browser?.storage||globalThis.chrome?.storage;get hasExtensionApi(){try{return!!this.getExtStorageApi()}catch(e){return console.error(e),!1}}isWatchSupported=()=>this.hasExtensionApi;keyNamespace="";isValidKey=e=>e.startsWith(this.keyNamespace);getNamespacedKey=e=>`${this.keyNamespace}${e}`;getUnnamespacedKey=e=>e.slice(this.keyNamespace.length);serde={serializer:JSON.stringify,deserializer:JSON.parse};constructor({area:e="sync",allCopied:t=!1,copiedKeyList:r=[],serde:a={}}={}){this.setCopiedKeySet(r),this.#a=e,this.#i=t,this.serde={...this.serde,...a};try{this.hasWebApi&&(t||r.length>0)&&(this.#r=window.localStorage)}catch{}try{this.hasExtensionApi&&(this.#e=this.getExtStorageApi(),i()?this.#t=(0,n.default)(this.#e[this.area],{exclude:["getBytesInUse"],errorFirst:!1}):this.#t=this.#e[this.area])}catch{}}setCopiedKeySet(e){this.#n=new Set(e)}rawGetAll=()=>this.#t?.get();getAll=async()=>Object.entries(await this.rawGetAll()).filter(([e])=>this.isValidKey(e)).reduce((e,[t,r])=>(e[this.getUnnamespacedKey(t)]=r,e),{});copy=async e=>{let t=void 0===e;if(!t&&!this.copiedKeySet.has(e)||!this.allCopied||!this.hasExtensionApi)return!1;let r=this.allCopied?await this.rawGetAll():await this.#t.get((t?[...this.copiedKeySet]:[e]).map(this.getNamespacedKey));if(!r)return!1;let a=!1;for(let e in r){let t=r[e],s=this.#r?.getItem(e);this.#r?.setItem(e,t),a||=t!==s}return a};rawGet=async e=>(await this.rawGetMany([e]))[e];rawGetMany=async e=>this.hasExtensionApi?await this.#t.get(e):e.filter(this.isCopied).reduce((e,t)=>(e[t]=this.#r?.getItem(t),e),{});rawSet=async(e,t)=>await this.rawSetMany({[e]:t});rawSetMany=async e=>(this.#r&&Object.entries(e).filter(([e])=>this.isCopied(e)).forEach(([e,t])=>this.#r.setItem(e,t)),this.hasExtensionApi&&await this.#t.set(e),null);clear=async(e=!1)=>{e&&this.#r?.clear(),await this.#t.clear()};rawRemove=async e=>{await this.rawRemoveMany([e])};rawRemoveMany=async e=>{this.#r&&e.filter(this.isCopied).forEach(e=>this.#r.removeItem(e)),this.hasExtensionApi&&await this.#t.remove(e)};removeAll=async()=>{let e=Object.keys(await this.getAll());await this.removeMany(e)};watch=e=>{let t=this.isWatchSupported();return t&&this.#o(e),t};#o=e=>{for(let t in e){let r=this.getNamespacedKey(t),a=this.#s.get(r)?.callbackSet||new Set;if(a.add(e[t]),a.size>1)continue;let s=(e,t)=>{if(t!==this.area||!e[r])return;let a=this.#s.get(r);if(!a)throw Error(`Storage comms does not exist for nsKey: ${r}`);Promise.all([this.parseValue(e[r].newValue),this.parseValue(e[r].oldValue)]).then(([e,r])=>{for(let s of a.callbackSet)s({newValue:e,oldValue:r},t)})};this.#e.onChanged.addListener(s),this.#s.set(r,{callbackSet:a,listener:s})}};unwatch=e=>{let t=this.isWatchSupported();return t&&this.#l(e),t};#l(e){for(let t in e){let r=this.getNamespacedKey(t),a=e[t],s=this.#s.get(r);s&&(s.callbackSet.delete(a),0===s.callbackSet.size&&(this.#s.delete(r),this.#e.onChanged.removeListener(s.listener)))}}unwatchAll=()=>this.#c();#c(){this.#s.forEach(({listener:e})=>this.#e.onChanged.removeListener(e)),this.#s.clear()}async getItem(e){return this.get(e)}async getItems(e){return await this.getMany(e)}async setItem(e,t){await this.set(e,t)}async setItems(e){await await this.setMany(e)}async removeItem(e){return this.remove(e)}async removeItems(e){return await this.removeMany(e)}},l=class extends o{get=async e=>{let t=this.getNamespacedKey(e),r=await this.rawGet(t);return this.parseValue(r)};getMany=async e=>{let t=e.map(this.getNamespacedKey),r=await this.rawGetMany(t),a=await Promise.all(Object.values(r).map(this.parseValue));return Object.keys(r).reduce((e,t,r)=>(e[this.getUnnamespacedKey(t)]=a[r],e),{})};set=async(e,t)=>{let r=this.getNamespacedKey(e),a=this.serde.serializer(t);return this.rawSet(r,a)};setMany=async e=>{let t=Object.entries(e).reduce((e,[t,r])=>(e[this.getNamespacedKey(t)]=this.serde.serializer(r),e),{});return await this.rawSetMany(t)};remove=async e=>{let t=this.getNamespacedKey(e);return this.rawRemove(t)};removeMany=async e=>{let t=e.map(this.getNamespacedKey);return await this.rawRemoveMany(t)};setNamespace=e=>{this.keyNamespace=e};parseValue=async e=>{try{if(void 0!==e)return this.serde.deserializer(e)}catch(e){console.error(e)}}}},{pify:"2mL3q","@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],"2mL3q":[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"default",()=>i);let s=(e,t,r,a)=>function(...s){let n=t.promiseModule;return new n((n,i)=>{t.multiArgs?s.push((...e)=>{t.errorFirst?e[0]?i(e):(e.shift(),n(e)):n(e)}):t.errorFirst?s.push((e,t)=>{e?i(e):n(t)}):s.push(n);let o=this===r?a:this;Reflect.apply(e,o,s)})},n=new WeakMap;function i(e,t){t={exclude:[/.+(?:Sync|Stream)$/],errorFirst:!0,promiseModule:Promise,...t};let r=typeof e;if(!(null!==e&&("object"===r||"function"===r)))throw TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${null===e?"null":r}\``);let a=(e,r)=>{let a=n.get(e);if(a||(a={},n.set(e,a)),r in a)return a[r];let s=e=>"string"==typeof e||"symbol"==typeof r?r===e:e.test(r),i=Reflect.getOwnPropertyDescriptor(e,r),o=void 0===i||i.writable||i.configurable,l=t.include?t.include.some(e=>s(e)):!t.exclude.some(e=>s(e)),c=l&&o;return a[r]=c,c},i=new WeakMap,o=new Proxy(e,{apply(e,r,a){let n=i.get(e);if(n)return Reflect.apply(n,r,a);let l=t.excludeMain?e:s(e,t,o,e);return i.set(e,l),Reflect.apply(l,r,a)},get(e,r){let n=e[r];if(!a(e,r)||n===Function.prototype[r])return n;let l=i.get(n);if(l)return l;if("function"==typeof n){let r=s(n,t,o,e);return i.set(n,r),r}return n}});return o}},{"@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],"5FhUR":[function(e,t,r){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(r),a.export(r,"BASE_URL",()=>s),a.export(r,"GOOGLE_CREDENTIAL",()=>n),a.export(r,"ENDPOINT",()=>i);let s="https://api.webpilotai.com/hyrule/v1",n="GOOGLE_CREDENTIAL",i={GET_USER:"/user",GET_API_USAGE:"/user/apikey/usage"}},{"@parcel/transformer-js/src/esmodule-helpers.js":"f6DG4"}],knbGc:[function(e,t,r){var a=e("@plasmohq/messaging"),s=e("@plasmohq/storage"),n=e("@/config");chrome.runtime.onInstalled.addListener(e=>{e.reason===chrome.runtime.OnInstalledReason.INSTALL&&chrome.tabs.create({url:"https://account.webpilot.ai/"})});let i=new s.Storage,o=e=>{e&&(e.startsWith("chrome:")||e.startsWith("chrome-extension:")?chrome.action.setPopup({popup:"popup.html"}):chrome.action.setPopup({popup:""}))};chrome.tabs.onActivated.addListener(({tabId:e})=>{chrome.tabs.get(e,e=>{o(e?.url)})}),chrome.tabs.onUpdated.addListener(async(e,t)=>{o(t.url);let r=await i.get("RELOAD_TAB_ID");r&&"complete"===t.status&&(l(),i.remove("RELOAD_TAB_ID"))});let l=async()=>{await (0,a.sendToContentScript)({name:n.MESSAGING_EVENT.SHOW_POPUP})},c=async e=>{let t=await i.get(n.WEBPILOT_CONFIG_STORAGE_KEY);if(t&&t.isFinishSetup&&t.isAuth)try{await l()}catch(t){await i.set("RELOAD_TAB_ID",e.id),chrome.tabs.reload(e.id)}else{let t=e?.url;if(void 0===t)return;let r="https://account.webpilot.ai/",a=chrome?.runtime?.getURL("tabs/index.html");if(t===r||t===a)return;chrome.tabs.create({url:r})}};chrome.action.onClicked.addListener(c)},{"@plasmohq/messaging":"e7sqG","@plasmohq/storage":"3wfAg","@/config":"jKBVv"}]},["kgW6q"],"kgW6q","parcelRequire3cd7"),globalThis.define=t}(globalThis.define);